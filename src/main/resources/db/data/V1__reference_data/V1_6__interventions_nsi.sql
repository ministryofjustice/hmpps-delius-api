--Insert NSI Types
insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS01', 'Accommodation', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS01');

insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS02', 'Education, Training and Employment (ETE)', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS02');

insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS03', 'Finance, Benefits and Debt (FBD)', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS03');

insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS04', 'Dependency and Recovery (D&R)', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS04');

insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS05', 'Personal Wellbeing', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS05');

insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS06', 'Women''s Service', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS06');

insert into r_nsi_type
(NSI_TYPE_ID,CODE,DESCRIPTION,OFFENDER_LEVEL,EVENT_LEVEL,ALLOW_ACTIVE_DUPLICATES,ALLOW_INACTIVE_DUPLICATES,ENFORCEMENT_TYPE,SELECTABLE,CREATED_BY_USER_ID,CREATED_DATETIME,
 LAST_UPDATED_USER_ID,LAST_UPDATED_DATETIME,ROW_VERSION,RATE_CARD_FLAG,CRC_WORK_REQUESTS_DIARY_FLAG, NSI_PURPOSE_ID)
select (SELECT MAX(NSI_TYPE_ID) + 1 FROM R_NSI_TYPE), 'CRS07', 'Young Adult''s Personal Wellbeing', 0, 1, 1, 1, 0, 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, 0, 'Y', 'N',
       (select STANDARD_REFERENCE_LIST_ID from R_STANDARD_REFERENCE_LIST where REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI PURPOSE') and CODE_VALUE = 'NSI')
from dual WHERE NOT EXISTS (SELECT * FROM r_nsi_type WHERE CODE = 'CRS07');


--Link new NSI Types to Providers
insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS01'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS01')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS02'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS02')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS03'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS03')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS04'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS04')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS05'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS05')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS06'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS06')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

insert into R_NSI_TYPE_PROBATION_AREA (NSI_TYPE_ID, PROBATION_AREA_ID)
SELECT (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS07'), (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS')
from dual WHERE NOT EXISTS (SELECT * FROM R_NSI_TYPE_PROBATION_AREA WHERE NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS07')
                                                                      and PROBATION_AREA_ID = (select PROBATION_AREA_ID from PROBATION_AREA where CODE='CRS'))
;

--Link new NSI Types to NSI Statuses
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS01'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS01'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS01'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS01'))
;

insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS02'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS02'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS02'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS02'))
;

insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS03'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS03'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS03'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS03'))
;

insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS04'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS04'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS04'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS04'))
;

insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS05'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS05'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS05'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS05'))
;

insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS06'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS06'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS06'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS06'))
;

insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS07'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER'), 1
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'REFER') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS07'))
;
insert into R_NSI_TYPE_STATUS (NSI_TYPE_STATUS_ID, NSI_TYPE_ID, NSI_STATUS_ID, SEQUENCE_NO)
SELECT (SELECT MAX(NSI_TYPE_STATUS_ID) + 1 FROM R_NSI_TYPE_STATUS), (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS07'), (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG'), 2
from dual WHERE NOT EXISTS (select * from R_NSI_TYPE_STATUS where NSI_STATUS_ID = (select NSI_STATUS_ID from R_NSI_STATUS where code = 'INPROG') AND NSI_TYPE_ID = (SELECT NSI_TYPE_ID FROM r_nsi_type WHERE CODE = 'CRS07'))
;

--Insert Cancelled NSI outcome
insert into R_STANDARD_REFERENCE_LIST(STANDARD_REFERENCE_LIST_ID, CODE_VALUE, CODE_DESCRIPTION, SELECTABLE, CREATED_BY_USER_ID, CREATED_DATETIME, LAST_UPDATED_USER_ID, LAST_UPDATED_DATETIME, REFERENCE_DATA_MASTER_ID, SPG_INTEREST, SPG_OVERRIDE)
select (SELECT MAX(STANDARD_REFERENCE_LIST_ID) + 1 FROM R_STANDARD_REFERENCE_LIST), 'CRS01', 'CRS Referral Cancelled', 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI OUTCOME'), 0, 0
from dual where NOT EXISTS (select * from R_STANDARD_REFERENCE_LIST where CODE_VALUE = 'CRS01' and REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI OUTCOME'))
;

insert into R_STANDARD_REFERENCE_LIST(STANDARD_REFERENCE_LIST_ID, CODE_VALUE, CODE_DESCRIPTION, SELECTABLE, CREATED_BY_USER_ID, CREATED_DATETIME, LAST_UPDATED_USER_ID, LAST_UPDATED_DATETIME, REFERENCE_DATA_MASTER_ID, SPG_INTEREST, SPG_OVERRIDE)
select (SELECT MAX(STANDARD_REFERENCE_LIST_ID) + 1 FROM R_STANDARD_REFERENCE_LIST), 'CRS02', 'CRS Service Ended', 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI OUTCOME'), 0, 0
from dual where NOT EXISTS (select * from R_STANDARD_REFERENCE_LIST where CODE_VALUE = 'CRS02' and REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI OUTCOME'))
;

insert into R_STANDARD_REFERENCE_LIST(STANDARD_REFERENCE_LIST_ID, CODE_VALUE, CODE_DESCRIPTION, SELECTABLE, CREATED_BY_USER_ID, CREATED_DATETIME, LAST_UPDATED_USER_ID, LAST_UPDATED_DATETIME, REFERENCE_DATA_MASTER_ID, SPG_INTEREST, SPG_OVERRIDE)
select (SELECT MAX(STANDARD_REFERENCE_LIST_ID) + 1 FROM R_STANDARD_REFERENCE_LIST), 'CRS03', 'CRS Service Completed', 'Y', (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate, (SELECT USER_ID FROM USER_ WHERE DISTINGUISHED_NAME = 'DELIUS_SYSTEM_USER'), sysdate,
       (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI OUTCOME'), 0, 0
from dual where NOT EXISTS (select * from R_STANDARD_REFERENCE_LIST where CODE_VALUE = 'CRS03' and REFERENCE_DATA_MASTER_ID = (select REFERENCE_DATA_MASTER_ID from R_REFERENCE_DATA_MASTER where CODE_SET_NAME = 'NSI OUTCOME'))
;

--Link NSI Type to NSI Outcome
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS01' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS01' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS01' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;

insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS02' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS02' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS02' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;

insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS03' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS03' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS03' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;

insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS04' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS04' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS04' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;

insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS05' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS05' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS05' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;

insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS06' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS06' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS06' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;

insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS07' and noi.CODE_VALUE = 'CRS01' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS07' and noi.CODE_VALUE = 'CRS02' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;
insert into R_NSI_TYPE_OUTCOME(NSI_TYPE_ID, NSI_OUTCOME_ID)
select nt.NSI_TYPE_ID, noi.STANDARD_REFERENCE_LIST_ID
from R_NSI_TYPE nt, R_STANDARD_REFERENCE_LIST noi join R_REFERENCE_DATA_MASTER rdm on rdm.REFERENCE_DATA_MASTER_ID = noi.REFERENCE_DATA_MASTER_ID
where nt.CODE = 'CRS07' and noi.CODE_VALUE = 'CRS03' and rdm.CODE_SET_NAME = 'NSI OUTCOME'
  and NOT EXISTS
    (select * from R_NSI_TYPE_OUTCOME n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.NSI_OUTCOME_ID = noi.STANDARD_REFERENCE_LIST_ID)
;


--Link RAR Rqmnt to NSI Types
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS01'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS02'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS03'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS04'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS05'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS06'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;
insert into R_RQMNT_NSI_TYPE(RQMNT_TYPE_MAIN_CATEGORY_ID, NSI_TYPE_ID)
SELECT rmt.RQMNT_TYPE_MAIN_CATEGORY_ID, nt.NSI_TYPE_ID
from R_RQMNT_TYPE_MAIN_CATEGORY rmt, R_NSI_TYPE nt where rmt.CODE = 'F' and nt.CODE = 'CRS07'
                                                     and NOT EXISTS
        (select * from R_RQMNT_NSI_TYPE n where n.NSI_TYPE_ID = nt.NSI_TYPE_ID and n.RQMNT_TYPE_MAIN_CATEGORY_ID = rmt.RQMNT_TYPE_MAIN_CATEGORY_ID)
;